---
import BaseHead from "../../components/BaseHead.astro";
import Header from "../../components/Header.astro";
import Footer from "../../components/Footer.astro";
import config from "../../content/config/config.json";
import { getCollection } from "astro:content";
import FormattedDate from "../../components/FormattedDate.astro";
import "../../styles/blog.css";

const posts = (await getCollection("newsroom")).sort(
  (a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf()
);

const featuredPosts = posts.filter((post) => post.data.featured);
const featuredPost = featuredPosts[0]; // Take only the first featured post
const regularPosts = posts.filter((post) => post !== featuredPost); // All other posts (including other featured ones)

const metadata = {
  title: "News - Latest Updates and Announcements",
  description:
    "Stay informed with the latest news, events, and updates from the Old Anandians&#x27; Professional Forum (OAPF). Explore our newsroom for insights into our initiatives and community impact.",
};
---

<!doctype html>
<html lang="en">
  <head>
    <BaseHead title={metadata.title} description={metadata.description} />
    <style>
      main {
        width: 960px;
      }
      ul {
        list-style-type: none;
        padding: 0;
      }
    </style>
    <!-- Bootstrap -->
    <!-- <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"
      integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm"
      crossorigin="anonymous"
    />
    <script
      src="https://code.jquery.com/jquery-3.2.1.slim.min.js"
      integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
      crossorigin="anonymous"></script>
    <script
      src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js"
      integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
      crossorigin="anonymous"></script>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js"
      integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
      crossorigin="anonymous"></script> -->
  </head>
  <body>
    <Header />
    <section class="newsroom-section">
      <div class="newsroom-container">
        {
          featuredPost && (
            <article class="featured-post">
              <a
                href={`/newsroom/${featuredPost.id}`}
                class="featured-post-link"
              >
                <div class="featured-post-image">
                  <img
                    src={featuredPost.data.heroImage}
                    alt={featuredPost.data.title}
                    loading="lazy"
                  />
                </div>
                <div class="featured-post-content">
                  <div class="featured-post-date">
                    <FormattedDate date={featuredPost.data.pubDate} />
                  </div>
                  <h1
                    class="featured-post-title"
                    set:html={featuredPost.data.title}
                  />
                  <p
                    class="featured-post-description"
                    set:html={featuredPost.data.description}
                  />
                  <div class="author-info">
                    {featuredPost.data.authors?.map((author) => (
                      <div class="author-item">
                        <img
                          src={author.avatar}
                          alt={author.name}
                          class="author-avatar"
                        />
                        <div class="author-details">
                          <span class="author-name">{author.name}</span>
                          <span class="author-designation">
                            {author.designation}
                          </span>
                        </div>
                      </div>
                    ))}
                  </div>
                </div>
              </a>
            </article>
          )
        }

        <div class="newsroom-grid">
          {
            regularPosts.map((post) => (
              <article class="newsroom-card">
                <a href={`/newsroom/${post.id}`} class="newsroom-card-link">
                  {post.data.heroImage && (
                    <div class="newsroom-card-image">
                      <img
                        src={post.data.heroImage}
                        alt={post.data.title}
                        loading="lazy"
                      />
                    </div>
                  )}
                  <div class="newsroom-card-content">
                    {post.data.pubDate && (
                      <div class="newsroom-card-date">
                        <FormattedDate date={post.data.pubDate} />
                      </div>
                    )}
                    {post.data.title && (
                      <h2
                        class="newsroom-card-title"
                        set:html={post.data.title}
                      />
                    )}
                    {post.data.description && (
                      <p
                        class="newsroom-card-description"
                        set:html={post.data.description}
                      />
                    )}
                    <div class="author-info">
                      {post.data.authors?.map((author) => (
                        <div class="author-item">
                          <img
                            src={author.avatar}
                            alt={author.name}
                            class="author-avatar"
                          />
                          <div class="author-details">
                            <span class="author-name">{author.name}</span>
                            <span class="author-designation">
                              {author.designation}
                            </span>
                          </div>
                        </div>
                      ))}
                    </div>
                  </div>
                </a>
              </article>
            ))
          }
        </div>
      </div>
    </section>

    <!-- Featured Authors Section -->
    <section class="featured-authors-section">
      <div class="newsroom-container">
        <h2 class="featured-authors-title">Featured Authors</h2>
        <div class="featured-authors-grid">
          <div class="featured-author-card">
            <img
              src="https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=150&h=150&fit=crop&crop=face"
              alt="Dr. Sarah Chen"
              class="featured-author-avatar"
            />
            <div class="featured-author-info">
              <h3 class="featured-author-name">Dr. Sarah Chen</h3>
              <p class="featured-author-designation">AI Research Director</p>
            </div>
          </div>

          <div class="featured-author-card">
            <img
              src="https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=150&h=150&fit=crop&crop=face"
              alt="Michael Rodriguez"
              class="featured-author-avatar"
            />
            <div class="featured-author-info">
              <h3 class="featured-author-name">Michael Rodriguez</h3>
              <p class="featured-author-designation">Sustainability Analyst</p>
            </div>
          </div>

          <div class="featured-author-card">
            <img
              src="https://images.unsplash.com/photo-1438761681033-6461ffad8d80?w=150&h=150&fit=crop&crop=face"
              alt="Dr. Emily Johnson"
              class="featured-author-avatar"
            />
            <div class="featured-author-info">
              <h3 class="featured-author-name">Dr. Emily Johnson</h3>
              <p class="featured-author-designation">Healthcare Innovation Lead</p>
            </div>
          </div>

          <div class="featured-author-card">
            <img
              src="https://images.unsplash.com/photo-1500648767791-00dcc994a43e?w=150&h=150&fit=crop&crop=face"
              alt="David Park"
              class="featured-author-avatar"
            />
            <div class="featured-author-info">
              <h3 class="featured-author-name">David Park</h3>
              <p class="featured-author-designation">Cybersecurity Expert</p>
            </div>
          </div>
        </div>
      </div>
    </section>

    <hr />
    <Footer />
  </body>
</html>
